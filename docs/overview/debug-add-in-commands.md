# ランタイムのログを使用してアドイン コマンドをデバッグする

Office 16 Desktop クライアントには、有用な情報をログに記録するために使用できる新しい機能があります。 アドイン マニフェストのエラーを診断するこのツールの機能は、アドイン コマンドを含むマニフェストを作成している場合に特に役に立ちます。 

機能の完全なドキュメントは作成中ですが、ここでは、アドイン コマンドを含むマニフェストの解析中の問題をデバッグするための使用方法について説明します。

##ランタイムのログを有効にする

**重要**: ランタイムのログには**パフォーマンスへの影響**があります。 アドインに関する問題をデバッグする必要がある場合にのみ有効にしてください。

1. ランタイムのログをサポートしているビルドを使用してください。 **Office 16 Desktop** クライアントのビルド **16.0.7019** 以上が必要です。
2. `HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\16.0\Wef\Developer\``RuntimeLogging` を追加します。 
3. キーの既定値にログを書き込むファイルの完全なパスを設定します。 [サンプル レジストリ キー](RuntimeLogging/EnableRuntimeLogging.zip)

レジストリは次のようになります。![](http://i.imgur.com/Sa9TyI6.png)

この機能を無効にする必要がある場合は、キーをレジストリから削除します。 

##コマンドでの問題を診断する
ランタイムのログは、リソース ID の不一致、無効な長さ、XSD スキーマ検証で検出されない問題など、検出するのが困難な**マニフェストの問題**を検出するのに役立ちます。 

手順は次のとおりです。
 
1. [Readme](https://github.com/OfficeDev/Office-Add-in-Commands-Samples/blob/master/README.md) の指示に従ってアドインをサイドロードします。 
2. リボン ボタン プロジェクトが表示されず、アドイン ダイアログに何も表示されない場合は、ログを確認します。
3. マニフェストで定義されているアドインの ID を検索し、アドインに関連するメッセージを探します。 ログではこの ID は `SolutionId` として報告されます。目的のアドインと関係のない多数のメッセージが表示されないように、一度に 1 つのアドインだけをサイドロードすることをお勧めします。 

次の例の RuntimeLogging は、存在しないリソース ファイルを参照しているコントロールの識別に役立ちます。 修正するには、綴りの誤りを改めるか (存在する場合)、存在しないリソースを追加します。

![](http://i.imgur.com/f8bouLA.png) 

##ログに関する既知の問題
ランタイムのログにはまだ既知のバグがあります。 紛らわしいメッセージや、不適切な分類のメッセージが表示されることがあります。 次に例を示します。

- メッセージ "`Medium  Current host not in add-in's host list`" の後の "`Unexpected Parsed manifest targeting different host`" は、正しく分類されていません。 これらはエラーではなく、無視してかまいません。
- メッセージ "`Unexpected   Add-in is missing required manifest fields  DisplayName`" には、問題のあるアドインの SolutionId が含まれません。 ただし、ほとんどの場合、これはデバッグしているアドインとは関係ありません。 
- `Monitorable` メッセージは、システムの観点からのエラーと予想されます。 場合によっては、マニフェストの問題を示していることがあります (スキップされたがマニフェスト失敗の原因にはならなかったスペル ミスのある要素など)。 

